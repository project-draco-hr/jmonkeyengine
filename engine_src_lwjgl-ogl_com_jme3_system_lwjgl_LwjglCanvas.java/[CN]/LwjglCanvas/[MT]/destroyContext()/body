{
  if (Display.isCreated()) {
    try {
      if (JmeSystem.getPlatform() == Platform.Windows32 || JmeSystem.getPlatform() == Platform.Windows64 || JmeSystem.getPlatform() == Platform.Linux32 || JmeSystem.getPlatform() == Platform.Linux64) {
        Display.setParent(null);
      }
    }
 catch (    LWJGLException ex) {
      logger.log(Level.SEVERE,"Encountered exception when setting parent to null",ex);
    }
    Display.destroy();
  }
  try {
    if (!needClose.get()) {
      makePbufferAvailable();
      pbuffer.makeCurrent();
      renderer.invalidateState();
    }
 else {
      if (pbuffer != null) {
        pbuffer.destroy();
      }
    }
  }
 catch (  LWJGLException ex) {
    listener.handleError("Failed make pbuffer available",ex);
  }
}
