{
  int start=-1;
  try {
    Caret caret=target.getCaret();
    int p0=Math.min(caret.getDot(),caret.getMark());
    int p1=Math.max(caret.getDot(),caret.getMark());
    doc.remove(p0,p1 - p0);
    start=caret.getDot();
    doc.insertString(start,s,null);
  }
 catch (  BadLocationException ble) {
  }
  return start;
}
