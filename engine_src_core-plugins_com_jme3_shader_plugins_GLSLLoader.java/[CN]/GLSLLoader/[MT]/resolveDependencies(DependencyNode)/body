{
  StringBuilder sb=new StringBuilder();
  List<DependencyNode> checkedNodes=new ArrayList<DependencyNode>();
  checkedNodes.add(root);
  while (true) {
    DependencyNode indepnNode=nextIndependentNode(checkedNodes);
    if (indepnNode == null)     break;
    sb.append(indepnNode.shaderSource).append('\n');
    dependCache.remove(indepnNode.shaderName);
    for (Iterator<DependencyNode> iter=indepnNode.dependOnMe.iterator(); iter.hasNext(); ) {
      DependencyNode dependNode=iter.next();
      iter.remove();
      dependNode.dependsOn.remove(indepnNode);
    }
  }
  return sb.toString();
}
