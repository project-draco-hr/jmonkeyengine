{
  InputStream in=null;
  Bitmap bitmap=null;
  try {
    in=info.openStream();
    bitmap=BitmapFactory.decodeStream(in);
    if (bitmap == null) {
      throw new IOException("Failed to load image: " + info.getKey().getName());
    }
  }
  finally {
    if (in != null)     in.close();
  }
  int width=bitmap.getWidth();
  int height=bitmap.getHeight();
  int bytesPerPixel=-1;
  Format fmt;
switch (bitmap.getConfig()) {
case ALPHA_8:
    bytesPerPixel=1;
  fmt=Format.Alpha8;
break;
case ARGB_4444:
bytesPerPixel=2;
fmt=Format.ARGB4444;
break;
case ARGB_8888:
bytesPerPixel=4;
fmt=Format.RGBA8;
break;
case RGB_565:
bytesPerPixel=2;
fmt=Format.RGB565;
break;
default :
return null;
}
Image image=new Image(fmt,width,height,null);
image.setEfficentData(bitmap);
return image;
}
