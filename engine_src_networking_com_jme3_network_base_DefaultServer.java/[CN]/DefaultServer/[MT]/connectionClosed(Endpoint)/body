{
  log.log(Level.INFO,"Connection closed:{0}.",p);
  Connection removed=null;
synchronized (this) {
    connecting.values().remove(p);
    removed=(Connection)endpointConnections.remove(p);
    if (removed != null) {
      connections.remove(removed.getId());
    }
    log.log(Level.FINE,"Connections size:{0}",connections.size());
    log.log(Level.FINE,"Endpoint mappings size:{0}",endpointConnections.size());
  }
  if (removed != null) {
    log.log(Level.INFO,"Client closed:{0}.",removed);
    removed.closeConnection();
  }
}
