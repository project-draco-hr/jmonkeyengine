{
  if (!JmeSystem.isLowPermissions()) {
    Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler(){
      public void uncaughtException(      Thread thread,      Throwable thrown){
        log.log(Level.SEVERE,"Uncaught exception thrown in " + thread.toString(),thrown);
      }
    }
);
  }
  while (keepAlive) {
    tcp.run();
    udp.run();
    if (delay > 0) {
      try {
        Thread.sleep(delay);
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
    }
 else {
      Thread.yield();
    }
  }
  try {
    tcp.cleanup();
    udp.cleanup();
  }
 catch (  IOException e) {
    log.log(Level.WARNING,"[???][???] Could not clean up the connection.",e);
    return;
  }
  alive=false;
  log.log(Level.FINE,"[???][???] Cleaned up TCP/UDP.");
}
