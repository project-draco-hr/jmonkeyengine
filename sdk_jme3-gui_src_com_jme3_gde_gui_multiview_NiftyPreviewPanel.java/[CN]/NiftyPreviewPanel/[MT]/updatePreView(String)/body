{
  final ProjectAssetManager pm=niftyObject.getLookup().lookup(ProjectAssetManager.class);
  if (pm == null) {
    Logger.getLogger(NiftyPreviewPanel.class.getName()).log(Level.WARNING,"No Project AssetManager found!");
  }
  try {
    doc=XMLUtil.parse(new InputSource(niftyObject.getPrimaryFile().getInputStream()),false,false,null,null);
    NiftyFileNode rootContext=new NiftyFileNode(doc.getDocumentElement());
    setRoot(rootContext);
    comp.setRootContext(rootContext);
  }
 catch (  Exception ex) {
    Message msg=new NotifyDescriptor.Message("Error parsing File:" + ex,NotifyDescriptor.ERROR_MESSAGE);
    DialogDisplayer.getDefault().notifyLater(msg);
    Exceptions.printStackTrace(ex);
    return;
  }
  SceneApplication.getApplication().enqueue(new Callable<Object>(){
    public Object call() throws Exception {
      try {
        nifty.fromXml(pm.getRelativeAssetPath(niftyObject.getPrimaryFile().getPath()),screen);
        if (screen == null || screen.length() == 0) {
          Collection<String> screens=nifty.getAllScreensName();
          for (Iterator<String> it=screens.iterator(); it.hasNext(); ) {
            String string=it.next();
            nifty.gotoScreen(string);
            return null;
          }
        }
      }
 catch (      Exception ex) {
        Message msg=new NotifyDescriptor.Message("Error opening File:" + ex,NotifyDescriptor.ERROR_MESSAGE);
        DialogDisplayer.getDefault().notifyLater(msg);
        Exceptions.printStackTrace(ex);
      }
      return null;
    }
  }
);
}
