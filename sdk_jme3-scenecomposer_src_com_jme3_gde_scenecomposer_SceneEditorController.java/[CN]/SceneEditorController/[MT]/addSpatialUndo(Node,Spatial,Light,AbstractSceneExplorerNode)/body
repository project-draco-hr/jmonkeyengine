{
  if (undoParent != null && undoSpatial != null) {
    Lookup.getDefault().lookup(SceneUndoRedoManager.class).addEdit(this,new AbstractUndoableSceneEdit(){
      @Override public void sceneUndo() throws CannotUndoException {
        undoSpatial.removeFromParent();
      }
      @Override public void sceneRedo() throws CannotRedoException {
        undoParent.attachChild(undoSpatial);
      }
      @Override public void awtRedo(){
        if (parentNode != null) {
          parentNode.refresh(true);
        }
      }
      @Override public void awtUndo(){
        if (parentNode != null) {
          parentNode.refresh(true);
        }
      }
    }
);
  }
  if (undoParent != null && undoLight != null) {
    Lookup.getDefault().lookup(SceneUndoRedoManager.class).addEdit(this,new AbstractUndoableSceneEdit(){
      @Override public void sceneUndo() throws CannotUndoException {
        undoParent.removeLight(undoLight);
        toolController.removeLightMarker(undoLight);
      }
      @Override public void sceneRedo() throws CannotRedoException {
        undoParent.addLight(undoLight);
        toolController.addLightMarker(undoLight);
      }
      @Override public void awtRedo(){
        if (parentNode != null) {
          parentNode.refresh(true);
        }
      }
      @Override public void awtUndo(){
        if (parentNode != null) {
          parentNode.refresh(true);
        }
      }
    }
);
  }
}
