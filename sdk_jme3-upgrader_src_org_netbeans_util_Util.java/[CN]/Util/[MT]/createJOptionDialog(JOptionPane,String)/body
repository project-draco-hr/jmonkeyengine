{
  final JDialog dialog=new JDialog(null,title,Dialog.ModalityType.APPLICATION_MODAL);
  Util.initIcons(dialog);
  Container contentPane=dialog.getContentPane();
  contentPane.setLayout(new BorderLayout());
  contentPane.add(pane,BorderLayout.CENTER);
  dialog.setResizable(false);
  dialog.pack();
  dialog.setLocationRelativeTo(null);
  WindowAdapter adapter=new WindowAdapter(){
    private boolean gotFocus=false;
    @Override public void windowClosing(    WindowEvent we){
      pane.setValue(null);
    }
    @Override public void windowGainedFocus(    WindowEvent we){
      if (!gotFocus) {
        pane.selectInitialValue();
        gotFocus=true;
      }
    }
  }
;
  dialog.addWindowListener(adapter);
  dialog.addWindowFocusListener(adapter);
  dialog.addComponentListener(new ComponentAdapter(){
    @Override public void componentShown(    ComponentEvent ce){
      pane.setValue(JOptionPane.UNINITIALIZED_VALUE);
    }
  }
);
  pane.addPropertyChangeListener(new PropertyChangeListener(){
    @Override public void propertyChange(    PropertyChangeEvent event){
      if (dialog.isVisible() && event.getSource() == pane && (event.getPropertyName().equals(JOptionPane.VALUE_PROPERTY)) && event.getNewValue() != null && event.getNewValue() != JOptionPane.UNINITIALIZED_VALUE) {
        dialog.setVisible(false);
      }
    }
  }
);
  return dialog;
}
