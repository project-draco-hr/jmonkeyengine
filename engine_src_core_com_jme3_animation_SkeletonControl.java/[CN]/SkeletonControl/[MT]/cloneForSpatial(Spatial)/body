{
  Node clonedNode=(Node)spatial;
  AnimControl ctrl=spatial.getControl(AnimControl.class);
  SkeletonControl clone=new SkeletonControl();
  clone.setSpatial(clonedNode);
  clone.skeleton=ctrl.getSkeleton();
  Mesh[] meshes=new Mesh[targets.length];
  for (int i=0; i < meshes.length; i++) {
    meshes[i]=((Geometry)clonedNode.getChild(i)).getMesh();
  }
  for (int i=meshes.length; i < clonedNode.getQuantity(); i++) {
    Spatial child=clonedNode.getChild(i);
    if (child instanceof Node) {
      Node clonedAttachNode=(Node)child;
      Bone originalBone=(Bone)clonedAttachNode.getUserData("AttachedBone");
      if (originalBone != null) {
        Bone clonedBone=clone.skeleton.getBone(originalBone.getName());
        clonedAttachNode.setUserData("AttachedBone",clonedBone);
        clonedBone.setAttachmentsNode(clonedAttachNode);
      }
    }
  }
  clone.targets=meshes;
  return clone;
}
