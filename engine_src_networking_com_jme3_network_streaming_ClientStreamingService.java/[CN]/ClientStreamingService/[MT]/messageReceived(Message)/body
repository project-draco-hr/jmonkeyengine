{
  if (message instanceof StreamMessage && !(message instanceof StreamDataMessage)) {
    StreamMessage msg=(StreamMessage)message;
    Stream stream=getStream(msg.getStreamID());
    if (stream != null) {
      for (      StreamListener listener : stream.getDataListeners()) {
        listener.streamCompleted(msg);
      }
    }
 else {
      stream=new Stream();
      stream.setMessage(msg);
      boolean accept=fireStreamOffered(stream,msg);
      streams.add(stream);
      if (accept) {
        try {
          client.send(msg);
        }
 catch (        IOException e) {
          e.printStackTrace();
        }
      }
    }
  }
 else   if (message instanceof StreamDataMessage) {
    StreamDataMessage dataMessage=(StreamDataMessage)message;
    Stream stream=getStream(dataMessage.getStreamID());
    if (stream == null) {
      log.log(Level.WARNING,"[StreamClient][TCP] We've received a data message even though we didn't register to the stream.");
      return;
    }
    for (    StreamListener listener : stream.getDataListeners()) {
      listener.streamDataReceived(dataMessage);
    }
  }
}
