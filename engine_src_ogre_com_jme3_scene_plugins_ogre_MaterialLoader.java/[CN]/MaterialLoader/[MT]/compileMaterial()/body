{
  Material mat;
  if (noLight) {
    mat=new Material(assetManager,"Common/MatDefs/Misc/Unshaded.j3md");
  }
 else {
    mat=new Material(assetManager,"Common/MatDefs/Light/Lighting.j3md");
  }
  if (blend) {
    RenderState rs=mat.getAdditionalRenderState();
    rs.setAlphaTest(true);
    rs.setAlphaFallOff(0.01f);
    rs.setBlendMode(RenderState.BlendMode.Alpha);
    if (twoSide)     rs.setFaceCullMode(RenderState.FaceCullMode.Off);
    mat.setTransparent(true);
    if (!noLight)     mat.setBoolean("UseAlpha",true);
  }
 else {
    if (twoSide) {
      RenderState rs=mat.getAdditionalRenderState();
      rs.setFaceCullMode(RenderState.FaceCullMode.Off);
    }
  }
  if (!noLight) {
    if (shinines > 0f) {
      mat.setFloat("Shininess",shinines);
    }
 else {
      mat.setFloat("Shininess",16f);
    }
    if (vcolor)     mat.setBoolean("UseVertexColor",true);
    if (texture != null)     mat.setTexture("DiffuseMap",texture);
    mat.setBoolean("UseMaterialColors",true);
    if (diffuse != null) {
      mat.setColor("Diffuse",diffuse);
    }
 else {
      mat.setColor("Diffuse",ColorRGBA.White);
    }
    if (ambient != null) {
      mat.setColor("Ambient",ambient);
    }
 else {
      mat.setColor("Ambient",ColorRGBA.DarkGray);
    }
    if (specular != null) {
      mat.setColor("Specular",specular);
    }
 else {
      mat.setColor("Specular",ColorRGBA.Black);
    }
    if (emissive != null) {
      mat.setColor("GlowColor",emissive);
    }
  }
 else {
    if (vcolor) {
      mat.setBoolean("VertexColor",true);
    }
    if (texture != null) {
      mat.setTexture("ColorMap",texture);
    }
    if (diffuse != null) {
      mat.setColor("Color",diffuse);
    }
    if (emissive != null) {
      mat.setColor("GlowColor",emissive);
    }
  }
  noLight=false;
  texture=null;
  diffuse=null;
  specular=null;
  texture=null;
  shinines=0f;
  vcolor=false;
  blend=false;
  return mat;
}
