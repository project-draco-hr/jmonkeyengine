{
  if (!pressed) {
    setDefaultAxisMarkerColors();
    pickedPlane=null;
    offset=null;
    if (wasDragging) {
      actionPerformed(new MoveUndo(selectedSpatial,startLoc,lastLoc));
      wasDragging=false;
    }
    return;
  }
  if (selectedSpatial == null)   return;
  if (pickedPlane == null) {
    pickedPlane=pickAxisMarker(camera,screenCoord,axisPickType);
    if (pickedPlane == null)     return;
    startLoc=selectedSpatial.getLocalTranslation().clone();
    if (pickedPlane.equals(new Vector3f(1,1,0)))     plane.setLocalRotation(XY);
 else     if (pickedPlane.equals(new Vector3f(1,0,1)))     plane.setLocalRotation(XZ);
 else     if (pickedPlane.equals(new Vector3f(0,1,1)))     plane.setLocalRotation(YZ);
    plane.setLocalTranslation(startLoc);
  }
  Vector3f planeHit=pickWorldLocation(camera,screenCoord,plane);
  if (planeHit == null)   return;
  if (offset == null)   offset=planeHit.subtract(startLoc);
  Vector3f newPos=planeHit.subtract(offset);
  lastLoc=newPos;
  selectedSpatial.setLocalTranslation(newPos);
  updateToolsTransformation(selectedSpatial);
  wasDragging=true;
}
