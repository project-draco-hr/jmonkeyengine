{
  if (!pressed) {
    setDefaultAxisMarkerColors();
    pickedMarker=null;
    lastScreenCoord=null;
    if (wasDragging) {
      actionPerformed(new ScaleUndo(toolController.getSelectedSpatial(),startRotate,lastRotate));
      wasDragging=false;
    }
    return;
  }
  if (toolController.getSelectedSpatial() == null) {
    return;
  }
  if (pickedMarker == null) {
    pickedMarker=pickAxisMarker(camera,screenCoord,axisPickType);
    if (pickedMarker == null) {
      return;
    }
    if (pickedMarker.equals(QUAD_XY)) {
      pickManager.initiatePick(toolController.getSelectedSpatial(),PickManager.PLANE_XY,PickManager.TransformationType.local,camera,screenCoord);
    }
 else     if (pickedMarker.equals(QUAD_XZ)) {
      pickManager.initiatePick(toolController.getSelectedSpatial(),PickManager.PLANE_XZ,PickManager.TransformationType.local,camera,screenCoord);
    }
 else     if (pickedMarker.equals(QUAD_YZ)) {
      pickManager.initiatePick(toolController.getSelectedSpatial(),PickManager.PLANE_YZ,PickManager.TransformationType.local,camera,screenCoord);
    }
    startRotate=toolController.getSelectedSpatial().getLocalRotation().clone();
  }
  if (!pickManager.updatePick(camera,screenCoord)) {
    return;
  }
  if (pickedMarker.equals(QUAD_XY) || pickedMarker.equals(QUAD_XZ) || pickedMarker.equals(QUAD_YZ)) {
    Quaternion rotation=startRotate.mult(pickManager.getLocalRotation());
    toolController.getSelectedSpatial().setLocalRotation(rotation);
    lastRotate=rotation;
  }
  updateToolsTransformation();
  wasDragging=true;
}
