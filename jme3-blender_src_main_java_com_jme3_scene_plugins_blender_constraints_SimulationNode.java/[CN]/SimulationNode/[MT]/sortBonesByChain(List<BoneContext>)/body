{
  Map<BoneContext,List<BoneContext>> branches=new HashMap<BoneContext,List<BoneContext>>();
  for (  BoneContext bone : bones) {
    BoneContext root=bone.getRoot();
    List<BoneContext> list=branches.get(root);
    if (list == null) {
      list=new ArrayList<BoneContext>();
      branches.put(root,list);
    }
    list.add(bone);
  }
  bones.clear();
  for (  Entry<BoneContext,List<BoneContext>> entry : branches.entrySet()) {
    Collections.sort(entry.getValue(),new Comparator<BoneContext>(){
      @Override public int compare(      BoneContext o1,      BoneContext o2){
        return o1.getDistanceFromRoot() - o2.getDistanceFromRoot();
      }
    }
);
    bones.addAll(entry.getValue());
  }
}
