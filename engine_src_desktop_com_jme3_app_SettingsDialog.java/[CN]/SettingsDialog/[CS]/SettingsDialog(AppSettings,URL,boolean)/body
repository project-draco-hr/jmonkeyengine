{
  if (source == null) {
    throw new NullPointerException("Settings source cannot be null");
  }
  this.source=source;
  this.imageFile=imageFile;
  setModal(true);
  setAlwaysOnTop(true);
  setResizable(false);
  AppSettings registrySettings=new AppSettings(true);
  String appTitle;
  if (source.getTitle() != null) {
    appTitle=source.getTitle();
  }
 else {
    appTitle=registrySettings.getTitle();
  }
  minWidth=source.getMinWidth();
  minHeight=source.getMinHeight();
  try {
    registrySettings.load(appTitle);
  }
 catch (  BackingStoreException ex) {
    logger.log(Level.WARNING,"Failed to load settings",ex);
  }
  if (loadSettings) {
    source.copyFrom(registrySettings);
  }
 else   if (!registrySettings.isEmpty()) {
    source.mergeFrom(registrySettings);
  }
  GraphicsDevice device=GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
  modes=device.getDisplayModes();
  Arrays.sort(modes,new DisplayModeSorter());
  createUI();
}
