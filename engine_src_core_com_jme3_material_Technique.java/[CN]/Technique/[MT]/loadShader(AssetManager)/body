{
  DefineList allDefines=new DefineList();
  allDefines.addFrom(def.getShaderPresetDefines());
  allDefines.addFrom(defines);
  ShaderKey key=new ShaderKey(def.getVertexShaderName(),def.getFragmentShaderName(),allDefines,def.getVertexShaderLanguage(),def.getFragmentShaderLanguage());
  shader=manager.loadShader(key);
  worldBindUniforms.clear();
  if (def.getWorldBindings() != null) {
    for (    UniformBinding binding : def.getWorldBindings()) {
      Uniform uniform=shader.getUniform("g_" + binding.name());
      uniform.setBinding(binding);
      if (uniform != null) {
        worldBindUniforms.add(uniform);
      }
    }
  }
  needReload=false;
}
