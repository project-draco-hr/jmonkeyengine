{
  checkRunning();
  if (waitForConnected) {
    waitForConnected();
  }
  ByteBuffer buffer=MessageProtocol.messageToBuffer(message,null);
  if (message.isReliable() || fast == null) {
    if (reliable == null)     throw new RuntimeException("No reliable connector configured");
    reliableAdapter.write(buffer);
  }
 else {
    fastAdapter.write(buffer);
  }
}
