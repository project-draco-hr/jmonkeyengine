{
  checkRunning();
  ByteBuffer buffer=messageToBuffer(message);
  if (message.isReliable() || fast == null) {
    if (reliable == null)     throw new RuntimeException("No reliable connector configured");
    reliable.write(buffer);
  }
 else {
    fast.write(buffer);
  }
}
