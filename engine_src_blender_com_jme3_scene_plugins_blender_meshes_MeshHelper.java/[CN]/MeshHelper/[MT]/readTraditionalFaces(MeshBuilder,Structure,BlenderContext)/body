{
  Pointer pMFace=(Pointer)meshStructure.getFieldValue("mface");
  List<Structure> mFaces=pMFace.isNotNull() ? pMFace.fetchData(blenderContext.getInputStream()) : null;
  if (mFaces != null && mFaces.size() > 0) {
    Pointer pMTFace=(Pointer)meshStructure.getFieldValue("mtface");
    List<Structure> mtFaces=null;
    if (pMTFace.isNotNull()) {
      mtFaces=pMTFace.fetchData(blenderContext.getInputStream());
      int facesAmount=((Number)meshStructure.getFieldValue("totface")).intValue();
      if (mtFaces.size() != facesAmount) {
        throw new BlenderFileException("The amount of faces uv coordinates is not equal to faces amount!");
      }
    }
    Vector2f[] uvCoordinatesForFace=new Vector2f[3];
    for (int i=0; i < mFaces.size(); ++i) {
      Structure mFace=mFaces.get(i);
      int materialNumber=((Number)mFace.getFieldValue("mat_nr")).intValue();
      boolean smooth=(((Number)mFace.getFieldValue("flag")).byteValue() & 0x01) != 0x00;
      DynamicArray<Number> uvs=null;
      if (mtFaces != null) {
        Structure mtFace=mtFaces.get(i);
        uvs=(DynamicArray<Number>)mtFace.getFieldValue("uv");
        uvCoordinatesForFace[0]=new Vector2f(uvs.get(0,0).floatValue(),uvs.get(0,1).floatValue());
        uvCoordinatesForFace[1]=new Vector2f(uvs.get(1,0).floatValue(),uvs.get(1,1).floatValue());
        uvCoordinatesForFace[2]=new Vector2f(uvs.get(2,0).floatValue(),uvs.get(2,1).floatValue());
      }
      int v1=((Number)mFace.getFieldValue("v1")).intValue();
      int v2=((Number)mFace.getFieldValue("v2")).intValue();
      int v3=((Number)mFace.getFieldValue("v3")).intValue();
      int v4=((Number)mFace.getFieldValue("v4")).intValue();
      meshBuilder.appendFace(v1,v2,v3,smooth,materialNumber,uvs == null ? null : uvCoordinatesForFace,false,i);
      if (v4 > 0) {
        if (uvs != null) {
          uvCoordinatesForFace[0]=new Vector2f(uvs.get(0,0).floatValue(),uvs.get(0,1).floatValue());
          uvCoordinatesForFace[1]=new Vector2f(uvs.get(2,0).floatValue(),uvs.get(2,1).floatValue());
          uvCoordinatesForFace[2]=new Vector2f(uvs.get(3,0).floatValue(),uvs.get(3,1).floatValue());
        }
        meshBuilder.appendFace(v1,v3,v4,smooth,materialNumber,uvs == null ? null : uvCoordinatesForFace,true,i);
      }
    }
  }
 else {
    Pointer pMEdge=(Pointer)meshStructure.getFieldValue("medge");
    List<Structure> mEdges=pMEdge.isNotNull() ? pMEdge.fetchData(blenderContext.getInputStream()) : null;
    if (mEdges != null && mEdges.size() > 0) {
      for (int i=0; i < mEdges.size(); ++i) {
        Structure mEdge=mEdges.get(i);
        boolean smooth=(((Number)mEdge.getFieldValue("flag")).byteValue() & 0x01) != 0x00;
        int v1=((Number)mEdge.getFieldValue("v1")).intValue();
        int v2=((Number)mEdge.getFieldValue("v2")).intValue();
        meshBuilder.appendEdge(v1,v2,smooth);
      }
    }
  }
}
