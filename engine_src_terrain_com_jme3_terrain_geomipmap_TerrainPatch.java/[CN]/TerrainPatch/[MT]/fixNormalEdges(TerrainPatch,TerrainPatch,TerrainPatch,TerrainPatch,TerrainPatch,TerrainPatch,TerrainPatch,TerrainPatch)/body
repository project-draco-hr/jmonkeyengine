{
  Vector3f rootPoint=new Vector3f();
  Vector3f rightPoint=new Vector3f();
  Vector3f leftPoint=new Vector3f();
  Vector3f topPoint=new Vector3f();
  Vector3f bottomPoint=new Vector3f();
  Vector3f tangent=new Vector3f();
  Vector3f binormal=new Vector3f();
  Vector3f normal=new Vector3f();
  int s=this.getSize() - 1;
  if (right != null) {
    for (int i=0; i < s + 1; i++) {
      rootPoint.set(s,this.getHeightmapHeight(s,i),i);
      leftPoint.set(s - 1,this.getHeightmapHeight(s - 1,i),i);
      rightPoint.set(s + 1,right.getHeightmapHeight(1,i),i);
      if (i == 0) {
        if (top == null) {
          bottomPoint.set(s,this.getHeightmapHeight(s,i + 1),i + 1);
          averageNormalsTangents(null,rootPoint,leftPoint,bottomPoint,rightPoint,null,null,null,null,null,normal,tangent,binormal);
          setInBuffer(this.getMesh(),s,normal,tangent,binormal);
          setInBuffer(right.getMesh(),0,normal,tangent,binormal);
        }
 else {
          topPoint.set(s,top.getHeightmapHeight(s,s - 1),i - 1);
          bottomPoint.set(s,this.getHeightmapHeight(s,i + 1),i + 1);
          averageNormalsTangents(topPoint,rootPoint,leftPoint,bottomPoint,rightPoint,null,null,null,null,null,normal,tangent,binormal);
          setInBuffer(this.getMesh(),s,normal,tangent,binormal);
          setInBuffer(right.getMesh(),0,normal,tangent,binormal);
          if (topRight != null) {
            setInBuffer(topRight.getMesh(),(s + 1) * s,normal,tangent,binormal);
          }
        }
      }
 else       if (i == s) {
        if (bottom == null) {
          topPoint.set(s,this.getHeightmapHeight(s,i - 1),i - 1);
          averageNormalsTangents(topPoint,rootPoint,leftPoint,null,rightPoint,null,null,null,null,null,normal,tangent,binormal);
          setInBuffer(this.getMesh(),(s + 1) * (i + 1) - 1,normal,tangent,binormal);
          setInBuffer(right.getMesh(),(s + 1) * (s),normal,tangent,binormal);
        }
 else {
          topPoint.set(s,this.getHeightmapHeight(s,i - 1),i - 1);
          bottomPoint.set(s,bottom.getHeightmapHeight(s,1),i + 1);
          averageNormalsTangents(topPoint,rootPoint,leftPoint,bottomPoint,rightPoint,null,null,null,null,null,normal,tangent,binormal);
          setInBuffer(this.getMesh(),(s + 1) * (s + 1) - 1,normal,tangent,binormal);
          setInBuffer(right.getMesh(),(s + 1) * s,normal,tangent,binormal);
          setInBuffer(bottom.getMesh(),s,normal,tangent,binormal);
          if (bottomRight != null) {
            setInBuffer(bottomRight.getMesh(),0,normal,tangent,binormal);
          }
        }
      }
 else {
        topPoint.set(s,this.getHeightmapHeight(s,i - 1),i - 1);
        bottomPoint.set(s,this.getHeightmapHeight(s,i + 1),i + 1);
        averageNormalsTangents(topPoint,rootPoint,leftPoint,bottomPoint,rightPoint,null,null,null,null,null,normal,tangent,binormal);
        setInBuffer(this.getMesh(),(s + 1) * (i + 1) - 1,normal,tangent,binormal);
        setInBuffer(right.getMesh(),(s + 1) * (i),normal,tangent,binormal);
      }
    }
  }
  if (left != null) {
    for (int i=0; i < s + 1; i++) {
      rootPoint.set(0,this.getHeightmapHeight(0,i),i);
      leftPoint.set(-1,left.getHeightmapHeight(s - 1,i),i);
      rightPoint.set(1,this.getHeightmapHeight(1,i),i);
      if (i == 0) {
        if (top == null) {
          bottomPoint.set(0,this.getHeightmapHeight(0,i + 1),i + 1);
          averageNormalsTangents(null,rootPoint,leftPoint,bottomPoint,rightPoint,null,null,null,null,null,normal,tangent,binormal);
          setInBuffer(this.getMesh(),0,normal,tangent,binormal);
          setInBuffer(left.getMesh(),s,normal,tangent,binormal);
        }
 else {
          topPoint.set(0,top.getHeightmapHeight(0,s - 1),i - 1);
          bottomPoint.set(0,this.getHeightmapHeight(0,i + 1),i + 1);
          averageNormalsTangents(topPoint,rootPoint,leftPoint,bottomPoint,rightPoint,null,null,null,null,null,normal,tangent,binormal);
          setInBuffer(this.getMesh(),0,normal,tangent,binormal);
          setInBuffer(left.getMesh(),s,normal,tangent,binormal);
          if (topLeft != null) {
            setInBuffer(topLeft.getMesh(),(s + 1) * (s + 1) - 1,normal,tangent,binormal);
          }
        }
      }
 else       if (i == s) {
        if (bottom == null) {
          topPoint.set(0,this.getHeightmapHeight(0,i - 1),i - 1);
          averageNormalsTangents(topPoint,rootPoint,leftPoint,null,rightPoint,null,null,null,null,null,normal,tangent,binormal);
          setInBuffer(this.getMesh(),(s + 1) * (s),normal,tangent,binormal);
          setInBuffer(left.getMesh(),(s + 1) * (i + 1) - 1,normal,tangent,binormal);
        }
 else {
          topPoint.set(0,this.getHeightmapHeight(0,i - 1),i - 1);
          bottomPoint.set(0,bottom.getHeightmapHeight(0,1),i + 1);
          averageNormalsTangents(topPoint,rootPoint,leftPoint,bottomPoint,rightPoint,null,null,null,null,null,normal,tangent,binormal);
          setInBuffer(this.getMesh(),(s + 1) * (s),normal,tangent,binormal);
          setInBuffer(left.getMesh(),(s + 1) * (i + 1) - 1,normal,tangent,binormal);
          setInBuffer(bottom.getMesh(),0,normal,tangent,binormal);
          if (bottomLeft != null) {
            setInBuffer(bottomLeft.getMesh(),s,normal,tangent,binormal);
          }
        }
      }
 else {
        topPoint.set(0,this.getHeightmapHeight(0,i - 1),i - 1);
        bottomPoint.set(0,this.getHeightmapHeight(0,i + 1),i + 1);
        averageNormalsTangents(topPoint,rootPoint,leftPoint,bottomPoint,rightPoint,null,null,null,null,null,normal,tangent,binormal);
        setInBuffer(this.getMesh(),(s + 1) * (i),normal,tangent,binormal);
        setInBuffer(left.getMesh(),(s + 1) * (i + 1) - 1,normal,tangent,binormal);
      }
    }
  }
  if (top != null) {
    for (int i=0; i < s + 1; i++) {
      rootPoint.set(i,this.getHeightmapHeight(i,0),0);
      topPoint.set(i,top.getHeightmapHeight(i,s - 1),-1);
      bottomPoint.set(i,this.getHeightmapHeight(i,1),1);
      if (i == 0) {
      }
 else       if (i == s) {
      }
 else {
        leftPoint.set(i - 1,this.getHeightmapHeight(i - 1,0),0);
        rightPoint.set(i + 1,this.getHeightmapHeight(i + 1,0),0);
        averageNormalsTangents(topPoint,rootPoint,leftPoint,bottomPoint,rightPoint,null,null,null,null,null,normal,tangent,binormal);
        setInBuffer(this.getMesh(),i,normal,tangent,binormal);
        setInBuffer(top.getMesh(),(s + 1) * (s) + i,normal,tangent,binormal);
      }
    }
  }
  if (bottom != null) {
    for (int i=0; i < s + 1; i++) {
      rootPoint.set(i,this.getHeightmapHeight(i,s),s);
      topPoint.set(i,this.getHeightmapHeight(i,s - 1),s - 1);
      bottomPoint.set(i,bottom.getHeightmapHeight(i,1),s + 1);
      if (i == 0) {
      }
 else       if (i == s) {
      }
 else {
        leftPoint.set(i - 1,this.getHeightmapHeight(i - 1,s),s);
        rightPoint.set(i + 1,this.getHeightmapHeight(i + 1,s),s);
        averageNormalsTangents(topPoint,rootPoint,leftPoint,bottomPoint,rightPoint,null,null,null,null,null,normal,tangent,binormal);
        setInBuffer(this.getMesh(),(s + 1) * (s) + i,normal,tangent,binormal);
        setInBuffer(bottom.getMesh(),i,normal,tangent,binormal);
      }
    }
  }
}
