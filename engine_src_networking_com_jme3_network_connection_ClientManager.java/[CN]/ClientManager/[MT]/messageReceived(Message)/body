{
  ClientRegistrationMessage regMessage=(ClientRegistrationMessage)message;
  ClientRegistrationMessage existingMessage=findMessage(regMessage.getId());
  if (existingMessage == null) {
    pendingMessages.add(regMessage);
    return;
  }
  Client client=new Client(true);
  Connection conOne=regMessage.getConnection();
  Connection conTwo=existingMessage.getConnection();
  if (conOne instanceof TCPConnection) {
    fillInTCPInfo(client,regMessage);
  }
 else   if (conOne instanceof UDPConnection) {
    fillInUDPInfo(client,regMessage);
  }
  if (conTwo instanceof TCPConnection) {
    fillInTCPInfo(client,existingMessage);
  }
 else   if (conTwo instanceof UDPConnection) {
    fillInUDPInfo(client,existingMessage);
  }
  if (client.getUDPConnection() == null || client.getTCPConnection() == null) {
    log.severe("[ClientManager][???] Something went wrong in the client registration process.");
    return;
  }
  client.setPlayerID(regMessage.getId());
  regMessage.getClient().setPlayerID(regMessage.getId());
  existingMessage.getClient().setPlayerID(regMessage.getId());
  fireClientConnected(client);
  pendingMessages.remove(existingMessage);
  clients.add(client);
  clientsByClientID.put(client.getClientID(),client);
}
