{
  String targetPath=(transformation != null) ? transformation.transformPath(sourceFile.getPath()) : sourceFile.getPath();
  boolean isTransformed=!targetPath.equals(sourceFile.getPath());
  FileObject tg=targetRoot.getFileObject(targetPath);
  try {
    if (tg == null) {
      FileObject targetFolder=null;
      String name=null, ext=null;
      if (isTransformed) {
        FileObject targetFile=FileUtil.createData(targetRoot,targetPath);
        targetFolder=targetFile.getParent();
        name=targetFile.getName();
        ext=targetFile.getExt();
        targetFile.delete();
      }
 else {
        targetFolder=FileUtil.createFolder(targetRoot,sourceFile.getParent().getPath());
        name=sourceFile.getName();
        ext=sourceFile.getExt();
      }
      tg=FileUtil.copyFile(sourceFile,targetFolder,name,ext);
    }
  }
 catch (  IOException ex) {
    if (sourceFile.getNameExt().endsWith("_hidden")) {
      return;
    }
    throw ex;
  }
  FileUtil.copyAttributes(sourceFile,tg);
}
