{
  progressHandle.start(7);
  useCanvas="true".equals(NbPreferences.forModule(Installer.class).get("use_lwjgl_canvas","false"));
  try {
    AppSettings newSetting=new AppSettings(true);
    newSetting.setFrameRate(30);
    if ("true".equals(NbPreferences.forModule(Installer.class).get("use_opengl_1","false"))) {
      newSetting.setRenderer(AppSettings.LWJGL_OPENGL1);
    }
    if (!useCanvas) {
      newSetting.setCustomRenderer(AwtPanelsContext.class);
    }
    setSettings(newSetting);
    Logger.getLogger("com.jme3").addHandler(logHandler);
    setPauseOnLostFocus(false);
    if (useCanvas) {
      createCanvas();
      startCanvas(true);
    }
    fakeApp=new FakeApplication(rootNode,guiNode,assetManager,cam);
    nodeSync=new NodeSyncAppState();
    stateManager.attach(nodeSync);
    progressHandle.progress("initialize Base Application",1);
    if (!useCanvas) {
      start();
    }
  }
 catch (  Exception e) {
    SceneViewerTopComponent.showOpenGLError(e.toString());
    Exceptions.printStackTrace(e);
  }
catch (  Error e) {
    SceneViewerTopComponent.showOpenGLError(e.toString());
    Exceptions.printStackTrace(e);
  }
 finally {
    getProgressHandle().finish();
  }
}
