{
  if (capture) {
    capture=false;
    shotIndex++;
    renderer.readFrameBuffer(out,outBuf);
    File file=new File(appName + shotIndex + ".png").getAbsoluteFile();
    OutputStream outStream=null;
    try {
      outStream=new FileOutputStream(file);
      JmeSystem.writeImageFile(outStream,"png",outBuf,width,height);
    }
 catch (    IOException ex) {
      logger.log(Level.SEVERE,"Error while saving screenshot",ex);
    }
 finally {
      if (outStream != null) {
        try {
          outStream.close();
        }
 catch (        IOException ex) {
          logger.log(Level.SEVERE,"Error while saving screenshot",ex);
        }
      }
    }
  }
}
