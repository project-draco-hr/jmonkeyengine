{
  LOGGER.log(Level.INFO,"Getting tracks!");
  IpoHelper ipoHelper=dataRepository.getHelper(IpoHelper.class);
  int fps=dataRepository.getBlenderKey().getFps();
  int[] animationFrames=dataRepository.getBlenderKey().getAnimationFrames(objectName,animationName);
  Structure chanbase=(Structure)actionStructure.getFieldValue("chanbase");
  List<Structure> actionChannels=chanbase.evaluateListBase(dataRepository);
  if (actionChannels != null && actionChannels.size() > 0 && (bonesMap == null || bonesMap.size() == 0)) {
    throw new IllegalStateException("No bones found! Cannot proceed to calculating tracks!");
  }
  List<BoneTrack> tracks=new ArrayList<BoneTrack>();
  for (  Structure bActionChannel : actionChannels) {
    String name=bActionChannel.getFieldValue("name").toString();
    Integer boneIndex=bonesMap.get(name);
    if (boneIndex != null) {
      Pointer p=(Pointer)bActionChannel.getFieldValue("ipo");
      if (p.isNotNull()) {
        Structure ipoStructure=p.fetchData(dataRepository.getInputStream()).get(0);
        Ipo ipo=ipoHelper.createIpo(ipoStructure,dataRepository);
        tracks.add(ipo.calculateTrack(boneIndex.intValue(),animationFrames[0],animationFrames[1],fps));
      }
    }
  }
  return tracks.toArray(new BoneTrack[tracks.size()]);
}
