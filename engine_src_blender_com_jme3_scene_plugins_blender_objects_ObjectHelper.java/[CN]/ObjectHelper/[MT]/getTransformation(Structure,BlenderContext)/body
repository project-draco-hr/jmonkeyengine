{
  DynamicArray<Number> loc=(DynamicArray<Number>)objectStructure.getFieldValue("loc");
  DynamicArray<Number> size=(DynamicArray<Number>)objectStructure.getFieldValue("size");
  DynamicArray<Number> rot=(DynamicArray<Number>)objectStructure.getFieldValue("rot");
  Pointer pParent=(Pointer)objectStructure.getFieldValue("parent");
  Matrix4f parentInv=pParent.isNull() ? Matrix4f.IDENTITY : this.getMatrix(objectStructure,"parentinv");
  Matrix4f globalMatrix=new Matrix4f();
  globalMatrix.setTranslation(loc.get(0).floatValue(),loc.get(1).floatValue(),loc.get(2).floatValue());
  globalMatrix.setRotationQuaternion(new Quaternion().fromAngles(rot.get(0).floatValue(),rot.get(1).floatValue(),rot.get(2).floatValue()));
  Matrix4f localMatrix=parentInv.mult(globalMatrix);
  Vector3f translation=localMatrix.toTranslationVector();
  Quaternion rotation=localMatrix.toRotationQuat();
  Vector3f scale=parentInv.toScaleVector().multLocal(size.get(0).floatValue(),size.get(1).floatValue(),size.get(2).floatValue());
  if (fixUpAxis) {
    float y=translation.y;
    translation.y=translation.z;
    translation.z=y == 0 ? 0 : -y;
    y=rotation.getY();
    float z=rotation.getZ();
    rotation.set(rotation.getX(),z,y == 0 ? 0 : -y,rotation.getW());
    y=scale.y;
    scale.y=scale.z;
    scale.z=y;
  }
  Transform t=new Transform(translation,rotation);
  t.setScale(scale);
  return t;
}
