{
  bulletAppState=new BulletAppState();
  stateManager.attach(bulletAppState);
  flyCam.setMoveSpeed(100);
  setUpKeys();
  mat_terrain=new Material(assetManager,"Common/MatDefs/Terrain/Terrain.j3md");
  mat_terrain.setTexture("Alpha",assetManager.loadTexture("Textures/Terrain/splat/alphamap.png"));
  Texture grass=assetManager.loadTexture("Textures/Terrain/splat/grass.jpg");
  grass.setWrap(WrapMode.Repeat);
  mat_terrain.setTexture("Tex1",grass);
  mat_terrain.setFloat("Tex1Scale",64f);
  Texture dirt=assetManager.loadTexture("Textures/Terrain/splat/dirt.jpg");
  dirt.setWrap(WrapMode.Repeat);
  mat_terrain.setTexture("Tex2",dirt);
  mat_terrain.setFloat("Tex2Scale",32f);
  Texture rock=assetManager.loadTexture("Textures/Terrain/splat/road.jpg");
  rock.setWrap(WrapMode.Repeat);
  mat_terrain.setTexture("Tex3",rock);
  mat_terrain.setFloat("Tex3Scale",128f);
  AbstractHeightMap heightmap=null;
  Texture heightMapImage=assetManager.loadTexture("Textures/Terrain/splat/mountains512.png");
  heightmap=new ImageBasedHeightMap(heightMapImage.getImage());
  heightmap.load();
  terrain=new TerrainQuad("my terrain",65,513,heightmap.getHeightMap());
  terrain.setMaterial(mat_terrain);
  terrain.setLocalTranslation(0,-100,0);
  terrain.setLocalScale(2f,1f,2f);
  rootNode.attachChild(terrain);
  List<Camera> cameras=new ArrayList<Camera>();
  cameras.add(getCamera());
  TerrainLodControl control=new TerrainLodControl(terrain,cameras);
  terrain.addControl(control);
  CollisionShape terrainShape=CollisionShapeFactory.createMeshShape((Node)terrain);
  landscape=new RigidBodyControl(terrainShape,0);
  terrain.addControl(landscape);
  CapsuleCollisionShape capsuleShape=new CapsuleCollisionShape(1.5f,6f,1);
  player=new CharacterControl(capsuleShape,0.05f);
  player.setJumpSpeed(20);
  player.setFallSpeed(30);
  player.setGravity(30);
  player.setPhysicsLocation(new Vector3f(-10,10,10));
  bulletAppState.getPhysicsSpace().add(terrain);
  bulletAppState.getPhysicsSpace().add(player);
}
