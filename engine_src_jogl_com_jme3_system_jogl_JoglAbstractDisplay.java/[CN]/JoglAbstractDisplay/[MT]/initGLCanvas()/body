{
  device=GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
  GLCapabilities caps=new GLCapabilities(GLProfile.getDefault());
  canvas=new GLCanvas(caps){
    @Override public void addNotify(){
      super.addNotify();
      onCanvasAdded();
    }
    @Override public void removeNotify(){
      onCanvasRemoved();
      super.removeNotify();
    }
  }
;
  if (settings.isVSync()) {
    canvas.getGL().setSwapInterval(1);
  }
  canvas.setFocusable(true);
  canvas.requestFocus();
  canvas.setSize(settings.getWidth(),settings.getHeight());
  canvas.setIgnoreRepaint(true);
  canvas.addGLEventListener(this);
  renderer=new JoglRenderer();
}
