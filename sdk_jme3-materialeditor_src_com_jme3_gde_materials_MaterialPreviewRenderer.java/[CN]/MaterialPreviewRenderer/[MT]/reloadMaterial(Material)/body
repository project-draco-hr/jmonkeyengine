{
  ((ProjectAssetManager)mat.getMaterialDef().getAssetManager()).clearCache();
  Material dummy=new Material(mat.getMaterialDef());
  try {
    for (    MatParam matParam : mat.getParams()) {
      dummy.setParam(matParam.getName(),matParam.getVarType(),matParam.getValue());
    }
    if (mat.getActiveTechnique() != null) {
      dummy.selectTechnique(mat.getActiveTechnique().getDef().getName(),SceneApplication.getApplication().getRenderManager());
    }
    dummy.getAdditionalRenderState().set(mat.getAdditionalRenderState());
    Geometry dummyGeom=new Geometry("dummyGeom",new Box(1f,1f,1f));
    dummyGeom.setMaterial(dummy);
    SceneApplication.getApplication().getRenderManager().preloadScene(dummyGeom);
  }
 catch (  RendererException e) {
    Logger.getLogger(MaterialDebugAppState.class.getName()).log(Level.SEVERE,e.getMessage());
    java.awt.EventQueue.invokeLater(new Runnable(){
      public void run(){
        label.setIcon(Icons.error);
      }
    }
);
    return null;
  }
catch (  NullPointerException npe) {
    npe.printStackTrace();
    return null;
  }
  return dummy;
}
