{
  SerializerRegistration existingReg=getExactSerializerRegistration(cls);
  short id;
  if (existingReg != null) {
    id=existingReg.getId();
  }
 else {
    id=--nextId;
  }
  SerializerRegistration reg=new SerializerRegistration(serializer,cls,id);
  idRegistrations.put(id,reg);
  classRegistrations.put(cls,reg);
  log.log(Level.INFO,"Registered class[" + id + "]:{0} to:"+ serializer,cls);
  serializer.initialize(cls);
  return reg;
}
