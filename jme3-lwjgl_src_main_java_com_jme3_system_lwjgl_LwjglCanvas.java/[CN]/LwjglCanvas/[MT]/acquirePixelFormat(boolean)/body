{
  if (forPbuffer) {
    if (pbufferFormat == null) {
      pbufferFormat=new PixelFormat(settings.getBitsPerPixel(),0,settings.getDepthBits(),settings.getStencilBits(),0,0,0,0,settings.useStereo3D()).withSRGB(settings.getGammaCorrection());
    }
    return pbufferFormat;
  }
 else {
    if (canvasFormat == null) {
      int samples=getNumSamplesToUse();
      canvasFormat=new PixelFormat(settings.getBitsPerPixel(),0,settings.getDepthBits(),settings.getStencilBits(),samples,0,0,0,settings.useStereo3D()).withSRGB(settings.getGammaCorrection());
    }
    return canvasFormat;
  }
}
