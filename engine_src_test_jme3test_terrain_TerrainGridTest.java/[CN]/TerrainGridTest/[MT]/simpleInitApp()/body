{
  File file=new File("mountains.zip");
  if (!file.exists()) {
    assetManager.registerLocator("http://jmonkeyengine.googlecode.com/files/mountains.zip",HttpZipLocator.class);
  }
 else {
    assetManager.registerLocator("mountains.zip",ZipLocator.class);
  }
  this.flyCam.setMoveSpeed(100f);
  ScreenshotAppState state=new ScreenshotAppState();
  this.stateManager.attach(state);
  this.mat_terrain=new Material(this.assetManager,"Common/MatDefs/Terrain/HeightBasedTerrain.j3md");
  Texture grass=this.assetManager.loadTexture("Textures/Terrain/splat/grass.jpg");
  grass.setWrap(WrapMode.Repeat);
  this.mat_terrain.setTexture("region1ColorMap",grass);
  this.mat_terrain.setVector3("region1",new Vector3f(88,200,this.grassScale));
  Texture dirt=this.assetManager.loadTexture("Textures/Terrain/splat/dirt.jpg");
  dirt.setWrap(WrapMode.Repeat);
  this.mat_terrain.setTexture("region2ColorMap",dirt);
  this.mat_terrain.setVector3("region2",new Vector3f(0,90,this.dirtScale));
  Texture rock=this.assetManager.loadTexture("Textures/Terrain/Rock2/rock.jpg");
  rock.setWrap(WrapMode.Repeat);
  this.mat_terrain.setTexture("region3ColorMap",rock);
  this.mat_terrain.setVector3("region3",new Vector3f(198,260,this.rockScale));
  this.mat_terrain.setTexture("region4ColorMap",rock);
  this.mat_terrain.setVector3("region4",new Vector3f(198,260,this.rockScale));
  this.mat_terrain.setTexture("slopeColorMap",rock);
  this.mat_terrain.setFloat("slopeTileFactor",32);
  this.mat_terrain.setFloat("terrainSize",129);
  this.terrain=new TerrainGrid("terrain",65,257,new ImageBasedHeightMapGrid(assetManager,new Namer(){
    public String getName(    int x,    int y){
      return "Scenes/TerrainMountains/terrain_" + x + "_"+ y+ ".png";
    }
  }
));
  this.terrain.setMaterial(this.mat_terrain);
  this.terrain.setLocalTranslation(0,0,0);
  this.terrain.setLocalScale(2f,1f,2f);
  this.rootNode.attachChild(this.terrain);
  TerrainLodControl control=new TerrainLodControl(this.terrain,getCamera());
  this.terrain.addControl(control);
  final BulletAppState bulletAppState=new BulletAppState();
  stateManager.attach(bulletAppState);
  this.getCamera().setLocation(new Vector3f(0,256,0));
  this.viewPort.setBackgroundColor(new ColorRGBA(0.7f,0.8f,1f,1f));
  if (usePhysics) {
    terrain.addListener("physicsStartListener",new TerrainGridListener(){
      public void gridMoved(      Vector3f newCenter){
        terrain.removeListener("physicsStartListener");
        RigidBodyControl body=new RigidBodyControl(new HeightfieldCollisionShape(terrain.getHeightMap(),terrain.getLocalScale()),0);
        terrain.addControl(body);
        bulletAppState.getPhysicsSpace().add(terrain);
        CapsuleCollisionShape capsuleShape=new CapsuleCollisionShape(0.5f,1.8f,1);
        player3=new CharacterControl(capsuleShape,0.5f);
        player3.setJumpSpeed(20);
        player3.setFallSpeed(30);
        player3.setGravity(30);
        player3.setPhysicsLocation(new Vector3f(cam.getLocation().x,256,cam.getLocation().z));
        bulletAppState.getPhysicsSpace().add(player3);
        physicsAdded=true;
      }
      public Material tileLoaded(      Material material,      Vector3f cell){
        return material;
      }
    }
);
  }
  this.terrain.initialize(cam.getLocation());
  this.initKeys();
}
