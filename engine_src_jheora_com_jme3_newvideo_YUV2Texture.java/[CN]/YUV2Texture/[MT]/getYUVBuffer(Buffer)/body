{
  if (buf.object instanceof FilteredImageSource) {
    FilteredImageSource imgSrc=(FilteredImageSource)buf.object;
    try {
      Field srcField=imgSrc.getClass().getDeclaredField("src");
      srcField.setAccessible(true);
      return (YUVBuffer)srcField.get(imgSrc);
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
  }
 else   if (buf.object instanceof YUVBuffer) {
    return (YUVBuffer)buf.object;
  }
 else {
    throw new RuntimeException("Expected buffer");
  }
}
